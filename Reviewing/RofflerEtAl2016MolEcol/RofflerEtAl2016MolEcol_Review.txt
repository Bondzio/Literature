Summary
-------

Goal: Increase our understanding of the interplay of gene flow, natural selection, and genetic drift in shaping observable patterns of neutral and adaptive variation across space and among loci.
Comparison of population- vs. individual-based approaches (explain / briefly define) and in-depth quantification of strengths and weaknesses of commonly-used methods.
Assess the combined effects of varying dispersal distance and population size.

Strength: This article investigates complexities of this topic that are hard to deal with by means of analytical treatment, and instead uses comprehensive simulations. This is a welcome complementation of previous work.

Three selection regimes: a) two discrete adjacent environments, b) a linear selection gradient from north to south, and c) neutrality.

The study assumes a k-allele mutation model 

Main concerns
-------------

*) I was missing a discussion of the concept of Wright's (1943) neighbourhood size, both in the Introduction and with respect to the results. Under admittedly idealised settings, this concept links dispersal distance with population density. In particular, it suggests that dispersal distance (or its variance) and local population density form a compound parameter. The authors of the present study are also interested in the relation between dispersal distance and population size, albeit in a spatially more complex context and including selection. It would therefore be of interest to know what can be learnt in addition to Wright's concept, and how robust it is. In the same context, how do your findings relate to Shirk and Cushman (2014; Front. Ecol. Evol.)? They propose a way of inferring spatial variation in Wright's neighbourhood size, e.g. as a consequence of variation in resistance to gene flow. I wonder if this could be of use when trying to detect selection, as it acts as a resistance to gene flow. At least, please try to translate your parameter combinations under neutrality into Wright's neighbourhood size for reference.

*) In the Introduction, there is a lack of references to theoretical papers. Please also make sure you are citing the original papers for observations you summarise. Overall, the references seemed to be biased towards a landscape-genetic perspective, with a lack of population-genetic literature.

*) Please make an effort to reduce the length of the Introduction. I suggest shortening the parts where you highlight the advantages of simulation-based approaches.

*) There is an extensive literature on the evolution and maintenance of allele-frequency clines in scenarios similar to those considered in this paper (but under simplifying assumptions about demography). How do the results here relate to the classical literature? What is the novel insight?

*) I was puzzled to see that the number of migrants is estimated from simulated Fst, rather than estimated directly from the simulations, given that the latter are individual-based. In addition, in scenario b) ("gradient scenario") it is not clear what geogrphic units Fst (and other measures of divergence, e.g. D_est) would refer to; is it still the northern and southern portion of the entire range? Using Fst to estimate the number of migrants assumes an island model of migration and comes with several other problems (reviewed in Whitlock & McCauley 1999).

*) On the one hand, the authors claim to relax arguably constraining idealising assumptions made in classical population-genetic analyses (e.g. about demography and migration) using a simulation-based approach. This seems fine. But then they resort to measures of genetic divergence (e.g. Fst) and statistical tests (e.g. the Mantel test) that are based on these simplifying population-genetic models or otherwise potentially problematic assumptions (e.g. Guillot & Rousset 2013, Meth Ecol Evol) without further discussion. It may be fine to use Fst as a statistic in the current context, but I would discourage using it to infer the number of migrants. Similarly, the Mantel test may be appropriate here, but please do justify its use, in particular with respect to potential autocorrelation in both variables (genetic and geographic distances).

*) It was not clear to me whether the LOSITAN simulations used to generate the null-distribution of Fst were based on exactly the same demographic model as is assumed here by the authors. This important point should be clarified, and potential deviations discussed. It seems as if an island model (or a related version) is being used, but it is not clear.


Minor comments
--------------

l. 26: "Most research on natural selection, gene flow, and effective population sizeinteractions ..." -> "Most research on the interaction of natural selection, gene flow, and effective population size..."

l. 35: The symbols N_m and N_e have not been introduced. It may be better to spell out their meaning in the abstract.

l. 35-36: "highest" -> "higher"; "and lowest" -> "than"

l. 37: "Alternatively" -> "However"

l. 39-40: "in a selection gradient" -> "with a selection gradient (as opposed to XY)" [it should be clear what the alternative is to a selection gradient in your analyses]

l. 43: Remove spaces surrounding the dashes that indicate ranges. "in comparison to population-based methods 0.7 - 1.0" -> "in comparison to 0.7-1.0 for population-based methods"

l. 43-45 Replace by "We suggest using both population- and individual-based approaches in order to limit false positives and negatives.

l. 51: Insert "the" before "identification".

l. 55: Please include more recent references.

l. 62-63: Please include reference to theoretical papers.

l. 72;74-75;76: Please include references to theoretical and/or original papers.

l. 77-80: I am not sure if I would call this a 'debate'. It seems established that both outcomes are plausible (i.e. spatial correlation of neutral and adaptive markers vs. different spatial distributions), but it is very difficult make statistical inference about processes from these patterns. This is partly because we are still learning to understand what we should expect under different modes of selection, extents of linkage, and strength of genetic drift.

l. 80: Insert "that" after "predicts".

l. 80-81: Large population size and limited gene flow will, per se, not guarantee strong adaptive divergence among populations. Selection must be spatially heterogeneous for this to occur. Without selection, we would expect small populations to show the strongest differentiation (due to genetic drift).

l. 91: Insert a space after "Matala et al. 2014;".

l. 93-94: "To understand the roles and interaction between gene flow, population size, and natural selection..." -> "To understand the roles of gene flow, population size, natural selection, and their interactions..."


l. 94: "these" -> "the following"

l. 101-104: This was not very clear to me. Also, you might want to mention that candidate loci found via genome scans can inform functional studies and experiments directly testing the effect of selective agents.

l. 105: Delete "role and".

l. 107-108: It is not clear how you differentiate between 'selective gradients' and 'spatially distinct environments'. Do you refer to heterogeneous selection in continuous vs. discrete space? This differentiation is important, but you should make it more explicit. You could refer to Fig. 1 earlier on.

l. 108: "discrete, population-based models under ideal" -> "models of discrete populations combined with idealizing"

l. 109: Replace the hyphen in "Wright-Fisher" by an en-dash.

l. 110: "equivocal" -> "difficult"

l. 122-123: Please define what you mean by "population-based" vs. "correlation-based" early on. Is "correlation-based" equivalent to what you are later on calling "individual-based"? These distinctions seem crucial.

l. 127: ">1" -> "more than"

l. 140-144: I was again missing the specification that selection must be spatially heterogeneous for these predictions to make sense.


l. 156: 'Dispersal distance' is not appropriately defined. Does it refer to the mean or standard deviation of a dispersal kernel? Please clarify.

l. 155-160: Please start subsentences with a lowercase letter.

l. 157: Remove brackets around "s" (i.e. around the symbol for the selection coefficient).

l. 162: Insert comma before "which".

l. 162: Replace ", a computationally challenging and time-consuming endeavor" by a sentence explicitly stating the (approximate) computation time needed and the hardware used.

l. 164: Please also specify the population size (1000) of these initial simulations in the main text.

l. 168: Was Fst exactly or approximately equal to 0.02?

l. 171: What exactly to you mean by 'polygynous mating system'? E.g. random mating where both sexes can mate several times per breeding episode? What is the offspring distribution?

l. 172: Do you mean an inverse-chi-squared distribution? Otherwise, I do not understand what dispersal kernel you used.

l. 173: Are these loci unlinked? If so, pleas specify.

l. 174: You seem to be referring to mutation rates in humans (or at least mammals). How important is the exact value of the mutation rate? Could you speed up your simulations by increasing the mutation rate without loosing power to detect the signals you are interested in? Please specify what k you used. Or does k emerge from the simulation algorithm? Please clarify.

l. 177-179: On l. 158 you introduced selection in terms of reduced survival (which implied viability selection of the individual whose fitness is considered). Here, however, the fitness of an individual is defined in terms of the survival of its offspring, which to me implies fertility selection on the focal individual; yet, survival of the offspring depends on their genotype. Hence, fitness of the offspring is a function of their parental genotypes. Because of this, strictly speaking, you are not portraying the fitness of a single parent, but of a mating pair. In principle, this is feasible, but please make sure your specifications are consistent.

l. 180-183: Perhaps use a), b), and c) throughout instead of (a), (b), and (c), and then replace "a", "b", and "c" later on by a), b), and c), respectively (e.g. in l. 184, 189,...). Currently, the notation is inconsistent (cf. caption of Figure 1). Moreover, I find the term "present/absent" misleading, because selection is present if there is a difference in fitness between the two environments, not because it is present in the north but not in the south or vice versa. How about calling it "step-wise scenario" or similar?

l. 182: "a gradient with the strength of selection continuously distributed from..." -> "a linear gradient of selection strength from...".

l. 188: Adjust the font for the "aa" genotype to italic. Insert ", i.e. A allele is fully recessive" after "of 1.0". [Actually, this sentence is redundant to the one on l. 191-192 and could be omitted; but please add the remark about full recessivity of A there.] What is the reason for assuming full recessivity of the A allele (dominance of the deleterious allele "a")? Please motivate. Please remind the reader that you also consider a "strong" selection regime under a).

l. 194-196: "linkage disequilibrium method" -> "linkage-disequilibrium method". It is not clear if the references given at the end of the sentence refer to both the linkage-disequilibrium method and the jack-knife approach or only to the latter. Please add a sentence or two summarising the idea behind the linkage-disequilibrium method.

l. 197-198: Insert "the" before "number". I was puzzled to see that you use the Fst-based formula to estimate the number of migrants, rather than esimating it directly from your simulations. See major concerns above. Please replace the hyphen in the equation by a proper minus sign.

l. 203: Please give the formula for D_est for completeness.

l. 204: "the 1 loci" -> "the one locus"

l. 206: Insert "it" after "because".

l. 207: Set the "F" italic in "Fst". You say that D_est "scales linearly" but not with what. 

l. 209: You use "landscape genetics approach" here, probably to mean the same as "individual-based approache(s)" mentioned earlier (e.g. l. 44, l. 221, l. 258). Please use a minimum number of terms and be consistent for clarity.

l. 211: "only adaptive loci" -> "only the adaptive locus"

l. 212: Please justify the choice of using Dps and give the formula.

l. 212-213: "For each scenario, selection strength, and selection surface..." -> "For each scenario (i.e. combination of selection strength and selection regime), ..."; "the10" -> "ten" (?).

l. 212 ff: You seem to describe specifics that apply to both the population-based and individual-based approach from here on. Please start a new paragraph with "For each scenario". Did you also generate a time series of Dps? Please specify.

l. 220: I suggest introduting the various statistical tests before the description of how you computed the type I and II errors.

l. 224: Please adjust names of scenarios as appropriate (cf. previous comments; this applies to other places in the manuscript, too, but I will not mention it anymore).

l. 228: "1 locus" -> "one locus"

l. 230-231: Please correct position of "implemented in" and adjust the format of the citation.

l. 232: Do the assumptions underlying the LOSITAN software correspond exactly to the demographic model that you used in your neutral scenario? Please clarify / specify deviations.

l. 237-238: Please motivate what you use the FDR for, and mention how you computed confidence intervals (e.g. based on empirical percentiles?). You give more background on your use of FDR values to approximate p-values on l. 253-257, so I wonder if you could present this earlier on.

l. 239-248: As for the LOSITAN/Fdist approach above, it would be good to explain a bit more what assumptions are made by BayeScan about the underlying demographic model and how robust the method is to these. BayeScan assumes a "fission model" (Falush et al. 2003), which is close to Wright's (1931) island model, except that islands share a common ancestral population before becoming isolated. Foll & Gaggiotti (2006) tested the robustness of such types of methods to some deviations. It may be good to remind the reader of their main findings.

l. 241: It is not clear what "population-specific" (as opposed to "global") means in the context of the "gradient scenario"; does it still refer to north vs. south?

l. 245-248: My understanding was that Foll and Gaggiotti's BayeScan would only provide an advantage in the context of more than two populations, and unequal rates of gene flow and effective sizes among these. Since it is not clear to me with respect to which units you define Fst and migration (see previous comments), I cannot judge if BayeScan is really expected to be better than Fdist in your context. Essentially, the demographic models assumed by Beaumont and Nichols (1996) and Foll and Gaggiotti (2008) are the same. Beaumont and Nichols (1996) showed that their Fdist approach is quite robust to violations.

l. 251: Insert a space after "odds value to".

l. 251-253: Please improve the formulation of this sentence. I did not quite understand its meaning.

l. 259-260: It was unclear to me what you mean by "the probability of the presence of an allele given the sampling site environmental characteristics".

l. 262-266: I got confused about whether environmental variables are response or predictor variables. Please clarify. You seem to use latitude as a predictor, but say it is a response. Also, is it appropriate to use latitude as environmental variable in the "present/absent" scenario? Should you not use a Boolean variable instead that differentiates between "north" and "south"?

Figure 1: Please correct the "c.)", "a.)", and "b.)" to be consistent in the caption; set genotypes italic; fix the last sentence of the caption.

